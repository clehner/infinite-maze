<!doctype html>
<html>
<head>
	<title>The Infinite Maze</title>
	<meta charset="utf-8">
	
	<meta name="viewport" content="width=device-width">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="shortcut icon" href="images/favicon.ico">
	
	<link rel="stylesheet" type="text/css" href="styles/maze.css">
	<link rel="stylesheet" type="text/css" href="styles/infinitemaze.css">
	
	<script src="scripts/utils.js"></script>
	<script src="scripts/transitions.js"></script>
	<script src="scripts/couchdb.js"></script>
	<script src="scripts/mazeviewer.js"></script>
	<script src="scripts/infinitemaze.js"></script>
</head>
<body>
	<div id="app" class="layer">
		<div id="welcome" class="window">
			<h1>The<em>Infinite</em>Maze.com</h1>
			<div class="subtitle">massively multiplayer online maze</div>
			<h2>How to Play</h2>
			<ul>
				<li>The red dot is you.</li>
				<li>Move your mouse through the maze.</li>
				<li>Click and drag to scroll the screen.</li>
				<li>When you get to an empty square, you can draw in it.</li>
			</ul>
			<button id="enter-btn">Enter the Maze</button>
		</div>
		
		<div id="header">
			<div class="right">
				<button id="login-signup-btn" class="logout-only">Log in | Sign up</button>
				<span class="login-only">
					<a id="account-name-link" href=""></a>
					<button id="logout-btn">Log out</button>
				</span>
				<button id="help-link">Help</button>
			</div>
		</div>
		
		<div id="login-signup-window" class="window hidden">
			<!--<p>
				Login or sign up for an account so you can save your drawings to the maze.
			</p>-->
			<form id="signup-form" class="left half">
				<h2>Sign up</h2>
				<p>Username: <input id="signup-username"></p>
				<p>Password: <input id="signup-password" type="password"></p>
				<p>Email: <input id="signup-email"></p>
				<p><input type="submit" value="Sign up"></p>
				<div id="signup-result" class="error"></div>
			</form>
			<hr>
			<form id="login-form" class="right half">
				<h2>Log in</h2>
				<p>Username: <input id="login-username"></p>
				<p>Password: <input id="login-password" type="password"></p>
				<p><input type="submit" value="Log in">
					<input type="reset" value="Cancel"></p>
				<div id="login-result" class="error"></div>
			</form>
		</div>
		
		<div id="settings-window" class="window hidden">
			<h2>Your account</h2>
			<div class="error">This area is not working yet.</div>
			<form id="settings-form">
				<p>Username: <span id="settings-username" class="field"></span></p>
				<p>Current password to change: <input type="password" id="settings-password-current" class="field"></p>
				<p>New password: <input type="password" id="settings-password-new" class="field"></p>
				<p>Confirm new password: <input type="password" id="settings-password-confirm" class="field"></p>
				<p>Email: <input id="settings-email" class="field"></p>
				<p><input type="reset" value="Cancel"> <input type="submit" value="Update"></p>
			</form>
			<div id="settings-result" class="error"></div>
		</div>
		
		<div id="editor-toolbox" class="layer hidden">
			<div id="rules">
				<h3>Maze Rules</h3>
				Please allow a path to go from the entrance point of your square to at least two empty adjacent squares.
			</div>
			<div id="toolbox-palettes">
				<div class="toolbox-palette">
					<table class="picker" id="color-picker-light"></table>
					Paths
				</div>
				<div class="toolbox-palette">
					<table class="picker" id="color-picker-dark"></table>
					Walls
				</div>
				<div class="toolbox-palette">
					<table class="picker" id="size-picker"></table>
					&nbsp;
				</div>
				<div id="save-btns">
					<button id="save-btn" class="login-only">Save</button>
					<button disabled class="logout-only">Save</button>
					<button id="discard-btn">Discard</button>
					<span class="logout-only">
						<a href="" id="login-signup-link">Login or sign up</a> to save your drawing!
					</span>
				</div>
			</div>
		</div>
		
		<div id="overlay" class="layer"></div>
		<div id="maze" class="layer"></div>
	</div>
	
	<script>
	var data = {"maze":{"_id":{"id":"1"},"type":{"id":"maze"},"created_at":1287528459951,"title":"The Infinite Maze","format":"infinite-tiled","tile_size":[256,256],"start":[120,96]},"tiles":{"0":{"0":{"id":"91ceafb5136b418d88ab3012c0012642","creator":"cel"},"-1":{"id":"d2e1055c256927758539bff12b064a73"}},"1":{"-1":{"id":"d2e1055c256927758539bff12b071dc2"},"-2":{"id":"f3628094ada3dde0848694d02b00eb24"},"-3":{"id":"f3628094ada3dde0848694d02b02ae04"},"0":{"id":"f3628094ada3dde0848694d02b02eb76"}},"-1":{"-1":{"id":"f3628094ada3dde0848694d02b02a33d"},"0":{"id":"f3628094ada3dde0848694d02b031d5d"},"1":{"id":"f3628094ada3dde0848694d02b046dab"}},"2":{"-2":{"id":"f3628094ada3dde0848694d02b02c734"}}},"userCtx":{"db":"maze","name":"cel","roles":[]},"listen_changes":false};
	
	Couch.urlPrefix = ".";
	var mazesDb = Couch.db("db");

	InfiniteMaze.init(mazesDb, data, function () {
		this.welcomeWindow.hide();
	});
	</script>
</body>
</html>