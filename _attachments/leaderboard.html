<!doctype html>
<html>
<head>
	<title>Leaderboard</title>
	<meta charset="utf-8">
	<link rel="alternate" type="application/atom+xml" href="claims.xml">
	<style type="text/css">
	</style>
	<script src="scripts/couchdb.js"></script>
</head>
<body>
<h1>Top maze artists</h1>
<pre><ol id="result" start="0"></ol></pre>
<script type="text/javascript">
Couch.urlPrefix = "./";
var db = Couch.db("db");
function $(id) { return document.getElementById(id); }
var mazeId = "1";
db.view("maze/tiles_by_creator", {
	group: true,
	startkey: [mazeId],
	endkey: [mazeId, {}],
	success: function (resp) {
		$("result").innerHTML = resp.rows.map(function (row) {
			return {
				name: row.key[1] || "anonymous",
				tiles: row.value
			};
		}).sort(function (a, b) {
			return b.name > a.name;
		}).sort(function (a, b) {
			return b.tiles - a.tiles;
		}).map(function (user, i) {
			return "<li>" + user.name + " (" + user.tiles + ")<\/li>";
		}).join("");
	},
	error: function(a,b,c) {
		console.log(a,b,c);
	}
});
</script>
</body>
</html>